# Wrangler Configuration
# Marketer Suite API - Cloudflare Workers

# ============================================
# Base Configuration
# ============================================
name = "marketer-suite-api"
main = "src/index.ts"
compatibility_date = "2025-11-23"
compatibility_flags = ["nodejs_compat"]

# ============================================
# Development Environment
# ============================================
[env.development]
name = "marketer-suite-api-dev"
migrations_dir = "../../migrations"

[env.development.vars]
ENVIRONMENT = "development"

[[env.development.d1_databases]]
binding = "DB"
database_name = "marketer-suite-dev"
database_id = "e0d6e5b5-d062-4b27-b0a4-8c4839dce3e3"

[[env.development.kv_namespaces]]
binding = "JWT_CACHE"
id = "7d6a15aaf8884e8fa78cd138141ef022"

[[env.development.kv_namespaces]]
binding = "SESSIONS"
id = "8689632d208d4b7b9ab9a566e6e13886"

# ============================================
# Production Environment
# ============================================
[env.production]
name = "marketer-suite-api"
migrations_dir = "../../migrations"

[env.production.vars]
ENVIRONMENT = "production"

# D1 Database (Production)
# TODO: Create production database with: wrangler d1 create marketer-suite-prod
# [[env.production.d1_databases]]
# binding = "DB"
# database_name = "marketer-suite-prod"
# database_id = "d263a245-bc3c-4f3c-b118-a821ccbcb2bc"

# KV Namespaces (Production)
[[env.production.kv_namespaces]]
binding = "JWT_CACHE"
id = "TODO_PRODUCTION_JWT_CACHE_ID"

[[env.production.kv_namespaces]]
binding = "SESSIONS"
id = "TODO_PRODUCTION_SESSIONS_ID"

# ============================================
# Secrets (Set via: wrangler secret put <NAME> --env <environment>)
# ============================================
# Required secrets for both environments:
# - JWT_SECRET: Secret key for JWT signing
# - N8N_WEBHOOK_URL: N8N webhook endpoint for OTP emails
# - TURNSTILE_SECRET: Cloudflare Turnstile secret key
# - CASSO_API_KEY: CASSO payment API key
# - CASSO_WEBHOOK_SECRET: CASSO webhook verification secret
